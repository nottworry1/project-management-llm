<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: common-head('Task: ' + ${task.title})}"></head>
<body>

<div th:replace="~{fragments/header :: header}"></div>

<main class="container mt-4">
    <h2 th:text="${task.title}">Task Title</h2>
    <p><strong>Description:</strong> <span th:text="${task.description}"></span></p>
    <p><strong>Status:</strong> <span th:text="${task.taskStatus.name}"></span></p>
    <p><strong>Reporter:</strong> <span th:text="${task.reporter.username}"></span></p>

    <a class="btn btn-primary"
       th:href="@{/projects/{projectId}/tasks/{taskId}/edit(projectId=${task.project.id},taskId=${task.id})}">
        Edit
    </a>
    <a class="btn btn-secondary"
       th:href="@{/projects/{projectId}/tasks(projectId=${task.project.id})}">
        Back to Tasks
    </a>

    <h4>Comments</h4>
    <div th:each="comment : ${comments}"
         th:insert="~{fragments/comment :: commentRow(comment)}">
    </div>

    <h5>Add a comment</h5>
    <form th:action="@{/projects/{projectId}/tasks/{taskId}/comments(projectId=${task.project.id},taskId=${task.id})}"
          th:object="${newComment}"
          method="post">
        <div class="mb-3">
            <textarea th:field="*{text}" class="form-control" rows="3"></textarea>
            <div th:replace="~{fragments/error-message :: errorMessage('text')}"></div>
        </div>
        <button class="btn btn-primary">Post Comment</button>
    </form>

</main>

<div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>
